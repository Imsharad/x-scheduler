# X Automation

A minimal Python-based Twitter/X automation pipeline that posts tweets from a Google Sheet.

## Features

- **Minimalist Design**: Extremely lean codebase focused on the essentials
- **Google Sheets Integration**: Uses a Google Sheet for easy content management
- **Direct Posting**: Posts tweets without additional formatting
- **Flexible Scheduling**: Post at regular intervals or specific times
- **API Compliant**: Respects Twitter API rate limits and terms of service

## Project Structure

```
x-scheduler/
├── src/                     # Core source code
│   ├── __init__.py
│   ├── main.py              # Main execution script
│   ├── config.py            # Loads config from .env and config file
│   ├── google_sheet_source.py # Google Sheets content source
│   ├── processor.py         # Content processor 
│   ├── scheduler.py         # Sets up and runs the scheduling logic
│   ├── poster.py            # Handles interaction with the X API
│   └── utils.py             # Utility functions (logging, retry logic)
├── config/                  # Configuration files
│   ├── config.yaml          # Main configuration
│   └── google-credentials.json # Google Service Account credentials
├── logs/                    # Log files generated by the application
│   └── pipeline.log         # Main log file
├── deploy/                  # Deployment-related files
│   ├── README.md            # Deployment-specific documentation
│   └── aws_policy.json      # AWS IAM policy templates
├── tests/                   # Unit/Integration tests
├── .gitignore               # Git ignore file
├── README.md                # Project documentation
├── requirements.txt         # Python dependencies (pinned versions)
├── deploy.sh                # AWS deployment script
└── run.sh                   # Local execution script
```

## Local Setup

1. Clone the repository
2. Create a virtual environment:
   ```
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```
3. Install dependencies:
   ```
   pip install -r requirements.txt
   ```
4. Create a `.env` file in the project root with your Twitter API credentials:
   ```
   X_API_KEY=YOUR_API_KEY_HERE
   X_API_KEY_SECRET=YOUR_API_KEY_SECRET_HERE
   X_ACCESS_TOKEN=YOUR_ACCESS_TOKEN_HERE
   X_ACCESS_TOKEN_SECRET=YOUR_ACCESS_TOKEN_SECRET_HERE
   X_BEARER_TOKEN=YOUR_BEARER_TOKEN_HERE
   ```
5. Set up Google Sheets integration (see below)
6. Configure `src/cfg/config.yaml` to set your scheduling preferences

## AWS Deployment

For detailed AWS deployment instructions, see [deploy/README.md](deploy/README.md).

## Configuration

The `src/cfg/config.yaml` file controls the application:

```yaml
# Content source configuration
content_source_type: "google_sheet"

# Google Sheets configuration
google_sheet:
  sheet_id: "your-google-sheet-id"
  worksheet_name: "main"  # Optional: Change if your worksheet has a different name
  credentials_path: "config/google-credentials.json"

# Scheduling
schedule:
  mode: "interval"  # interval or specific_times
  interval_minutes: 60  # post every 1 hour
  specific_times:  # alternative to interval, ignored if mode is "interval"
    - "09:00"
    - "17:00"
    - "21:00"

# Logging
logging:
  file_path: "src/log/pipeline.log"
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
```

## Google Sheets Setup

1. **Create a Google Sheet** with at least the following columns:
   - `tweet` - The tweet text to post (column A)
   - `is_posted` - Leave empty for new tweets (column B)

2. **Create a Google Cloud Project and Service Account**:
   - Go to [Google Cloud Console](https://console.cloud.google.com/)
   - Create a new project (or use an existing one)
   - Enable the Google Sheets API for the project
   - Create a service account under "IAM & Admin > Service Accounts"
   - Create a key for the service account (JSON format)
   - Download and save the JSON key file to `config/google-credentials.json`

3. **Share Your Google Sheet** with the service account email (looks like `your-service-account@your-project.gserviceaccount.com`) with "Editor" permissions

4. **Update Configuration**:
   - Configure the `google_sheet` section in `config.yaml` with your Sheet ID and worksheet name

## Local Usage

Run the pipeline locally:

```bash
./run.sh
# OR with debug logging:
./run.sh --debug
```

## Running Locally in the Background

### Linux/Mac:
```
nohup ./run.sh > /dev/null 2>&1 &
```

### Windows:
Use Task Scheduler to run the script at system startup.

## Important Notes

- This is a minimal project designed for simplicity
- Make sure your Twitter API credentials have the necessary permissions
- Always respect Twitter's terms of service and rate limits
- The AWS deployment uses the free tier for the first 12 months ($0), then costs approximately $8-12/month after that period
- Never commit the Google service account credentials JSON file to your repository 